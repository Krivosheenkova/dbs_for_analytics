Главная задача: сделать RFM-анализ на основе данных по продажам за 2 года (из предыдущего дз).
​
Что делаем:
1. Определяем критерии для каждой буквы R, F, M (т.е. к примеру, R – 3 для клиентов, которые покупали <= 30 дней от последней даты в базе, R – 2 для клиентов, которые покупали > 30 и менее 60 дней от последней даты в базе и т.д.)

Regularity

SELECT user_id, o_date, DATEDIFF(@last_date, o_date) as days_ago FROM orders_20190822 WHERE DATEDIFF(@last_date, o_date);

1. 365+ days (860,751 users)
2. 101-365 days (709,976 users)
3. 61-100 days (131,647 users)
4. 31-60 days (131,882 users)
5. 0-30 days (168,504 users)



Frequency
1. 1-2 orders (879,503 users)
2. 3-10 (114,821 users)
3. 11-20 (18,283 users)
4. 21-50 (6,103 users)
5. 50+ (781 users)


Monetary

SELECT user_id, sum(price) sum FROM orders_20190822 WHERE price > 0 GROUP BY user_id;

1. 500 > SUM(price): (103,066 users)
2. 1000 > SUM(price) >= 500: (99,884 users)
3. 10000 > SUM(price) >= 1000: (644,662 users)
4. 50000 > SUM(price) >= 10000: (86,231 users) 
5. SUM(price) >= 50000: (6,655 users)

VIP USERS: "555", "455", "355", "345", "354", "445", "245", "255", "325", "335"

REGULAR USERS: "443", "441", "442", "444", "333", "341", "342", "343", "344", "321", "322", "323", "324", "334"

HOPEFUL USERS: "221", "222", "223", "224", "225", "231", "232", "233", "234", "235", "241", "242", "243", "244", "251", "252", "253", "254", "311", "312", "313", "314", "315"

LOST USERS: "111", "112", "113", "114", "115", "121", "122", "123", "124", "125", "211", "212"

2. Для каждого пользователя получаем набор из 3 цифр (от 111 до 333, где 333 – самые классные пользователи)
3. Вводим группировку, к примеру, 333 и 233 – это Vip, 1XX – это Lost, остальные Regular ( можете ввести боле глубокую сегментацию)
4. Для каждой группы из п. 3 находим кол-во пользователей, кот. попали в них и % товарооборота, которое они сделали на эти 2 года.
5. Проверяем, что общее кол-во пользователей бьется с суммой кол-во пользователей по группам из п. 3 (если у вас есть логические ошибки в создании групп, у вас не собьются цифры). То же самое делаем и по деньгам.
6. Результаты присылаем.
